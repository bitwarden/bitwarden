<ng-container *ngIf="loading">
  <div class="tw-flex tw-items-center tw-justify-center">
    <i class="bwi bwi-spinner bwi-spin bwi-3x" aria-hidden="true"></i>
  </div>
</ng-container>

<ng-container *ngIf="!loading">
  <form [bitSubmit]="submitForm" [formGroup]="form" autocomplete="off">
    <app-two-factor-auth-email
      (token)="token = $event"
      *ngIf="selectedProviderType === providerType.Email"
    />
    <app-two-factor-auth-authenticator
      (token)="token = $event"
      *ngIf="selectedProviderType === providerType.Authenticator"
    />
    <app-two-factor-auth-yubikey
      (token)="token = $event"
      *ngIf="selectedProviderType === providerType.Yubikey"
    />
    <app-two-factor-auth-webauthn
      (webAuthnResultEmitter)="processWebAuthnResult($event)"
      *ngIf="selectedProviderType === providerType.WebAuthn"
    />
    <app-two-factor-auth-duo
      (token)="token = $event; submitForm()"
      [providerData]="providerData"
      *ngIf="
        selectedProviderType === providerType.OrganizationDuo ||
        selectedProviderType === providerType.Duo
      "
      #duoComponent
    />
    <bit-form-control>
      <bit-label>{{ "dontAskAgainOnThisDeviceFor30Days" | i18n }}</bit-label>
      <input type="checkbox" bitCheckbox formControlName="remember" />
    </bit-form-control>
    <ng-container *ngIf="selectedProviderType == null">
      <p bitTypography="body1">{{ "noTwoStepProviders" | i18n }}</p>
      <p bitTypography="body1">{{ "noTwoStepProviders2" | i18n }}</p>
    </ng-container>
    <!-- Buttons -->
    <div class="tw-flex tw-flex-col tw-space-y-3 tw-mb-3">
      <button
        type="submit"
        buttonType="primary"
        bitButton
        bitFormButton
        *ngIf="showContinueButton()"
      >
        <span> {{ "continueLoggingIn" | i18n }} </span>
      </button>

      <button
        type="button"
        buttonType="primary"
        bitButton
        (click)="launchDuo()"
        *ngIf="
          selectedProviderType === providerType.Duo ||
          selectedProviderType === providerType.OrganizationDuo
        "
      >
        <span> {{ "launchDuo" | i18n }}</span>
      </button>

      <p class="tw-text-center">{{ "or" | i18n }}</p>

      <button
        type="button"
        buttonType="secondary"
        bitButton
        bitFormButton
        (click)="selectOtherTwofactorMethod()"
      >
        <span> {{ "selectAnotherMethod" | i18n }} </span>
      </button>

      <button
        type="button"
        buttonType="secondary"
        bitButton
        bitFormButton
        (click)="use2faRecoveryCode()"
      >
        <span> {{ "useYourRecoveryCode" | i18n }} </span>
      </button>
    </div>
  </form>
</ng-container>
